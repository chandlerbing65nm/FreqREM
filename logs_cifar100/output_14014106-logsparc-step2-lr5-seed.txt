/scratch/project_465002264/miniconda3/envs/rem/lib/python3.8/site-packages/timm/models/helpers.py:7: FutureWarning: Importing from timm.models.helpers is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/scratch/project_465002264/miniconda3/envs/rem/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/scratch/project_465002264/miniconda3/envs/rem/lib/python3.8/site-packages/timm/models/registry.py:4: FutureWarning: Importing from timm.models.registry is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:550: UserWarning: Overwriting vit_tiny_patch16_224 in registry with robustbench.model_zoo.vision_transformer_rem.vit_tiny_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_tiny_patch16_224(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:559: UserWarning: Overwriting vit_tiny_patch16_384 in registry with robustbench.model_zoo.vision_transformer_rem.vit_tiny_patch16_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_tiny_patch16_384(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:568: UserWarning: Overwriting vit_small_patch32_224 in registry with robustbench.model_zoo.vision_transformer_rem.vit_small_patch32_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_small_patch32_224(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:577: UserWarning: Overwriting vit_small_patch32_384 in registry with robustbench.model_zoo.vision_transformer_rem.vit_small_patch32_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_small_patch32_384(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:586: UserWarning: Overwriting vit_small_patch16_224 in registry with robustbench.model_zoo.vision_transformer_rem.vit_small_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_small_patch16_224(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:596: UserWarning: Overwriting vit_small_patch16_384 in registry with robustbench.model_zoo.vision_transformer_rem.vit_small_patch16_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_small_patch16_384(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:606: UserWarning: Overwriting vit_base_patch32_224 in registry with robustbench.model_zoo.vision_transformer_rem.vit_base_patch32_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch32_224(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:615: UserWarning: Overwriting vit_base_patch32_384 in registry with robustbench.model_zoo.vision_transformer_rem.vit_base_patch32_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch32_384(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:625: UserWarning: Overwriting vit_base_patch16_224 in registry with robustbench.model_zoo.vision_transformer_rem.vit_base_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch16_224(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:635: UserWarning: Overwriting vit_base_patch16_384 in registry with robustbench.model_zoo.vision_transformer_rem.vit_base_patch16_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch16_384(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:645: UserWarning: Overwriting vit_large_patch32_224 in registry with robustbench.model_zoo.vision_transformer_rem.vit_large_patch32_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_large_patch32_224(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:654: UserWarning: Overwriting vit_large_patch32_384 in registry with robustbench.model_zoo.vision_transformer_rem.vit_large_patch32_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_large_patch32_384(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:664: UserWarning: Overwriting vit_large_patch16_224 in registry with robustbench.model_zoo.vision_transformer_rem.vit_large_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_large_patch16_224(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:674: UserWarning: Overwriting vit_large_patch16_384 in registry with robustbench.model_zoo.vision_transformer_rem.vit_large_patch16_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_large_patch16_384(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:684: UserWarning: Overwriting vit_tiny_patch16_224_in21k in registry with robustbench.model_zoo.vision_transformer_rem.vit_tiny_patch16_224_in21k. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_tiny_patch16_224_in21k(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:695: UserWarning: Overwriting vit_small_patch32_224_in21k in registry with robustbench.model_zoo.vision_transformer_rem.vit_small_patch32_224_in21k. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_small_patch32_224_in21k(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:706: UserWarning: Overwriting vit_small_patch16_224_in21k in registry with robustbench.model_zoo.vision_transformer_rem.vit_small_patch16_224_in21k. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_small_patch16_224_in21k(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:717: UserWarning: Overwriting vit_base_patch32_224_in21k in registry with robustbench.model_zoo.vision_transformer_rem.vit_base_patch32_224_in21k. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch32_224_in21k(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:729: UserWarning: Overwriting vit_base_patch16_224_in21k in registry with robustbench.model_zoo.vision_transformer_rem.vit_base_patch16_224_in21k. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch16_224_in21k(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:741: UserWarning: Overwriting vit_large_patch32_224_in21k in registry with robustbench.model_zoo.vision_transformer_rem.vit_large_patch32_224_in21k. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_large_patch32_224_in21k(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:753: UserWarning: Overwriting vit_large_patch16_224_in21k in registry with robustbench.model_zoo.vision_transformer_rem.vit_large_patch16_224_in21k. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_large_patch16_224_in21k(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:765: UserWarning: Overwriting vit_huge_patch14_224_in21k in registry with robustbench.model_zoo.vision_transformer_rem.vit_huge_patch14_224_in21k. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_huge_patch14_224_in21k(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:777: UserWarning: Overwriting deit_tiny_patch16_224 in registry with robustbench.model_zoo.vision_transformer_rem.deit_tiny_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_tiny_patch16_224(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:787: UserWarning: Overwriting deit_small_patch16_224 in registry with robustbench.model_zoo.vision_transformer_rem.deit_small_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_small_patch16_224(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:797: UserWarning: Overwriting deit_base_patch16_224 in registry with robustbench.model_zoo.vision_transformer_rem.deit_base_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_base_patch16_224(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:807: UserWarning: Overwriting deit_base_patch16_384 in registry with robustbench.model_zoo.vision_transformer_rem.deit_base_patch16_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_base_patch16_384(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:817: UserWarning: Overwriting deit_tiny_distilled_patch16_224 in registry with robustbench.model_zoo.vision_transformer_rem.deit_tiny_distilled_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_tiny_distilled_patch16_224(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:828: UserWarning: Overwriting deit_small_distilled_patch16_224 in registry with robustbench.model_zoo.vision_transformer_rem.deit_small_distilled_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_small_distilled_patch16_224(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:839: UserWarning: Overwriting deit_base_distilled_patch16_224 in registry with robustbench.model_zoo.vision_transformer_rem.deit_base_distilled_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_base_distilled_patch16_224(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:850: UserWarning: Overwriting deit_base_distilled_patch16_384 in registry with robustbench.model_zoo.vision_transformer_rem.deit_base_distilled_patch16_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_base_distilled_patch16_384(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:861: UserWarning: Overwriting vit_base_patch16_224_miil_in21k in registry with robustbench.model_zoo.vision_transformer_rem.vit_base_patch16_224_miil_in21k. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch16_224_miil_in21k(pretrained=False, **kwargs):
/pfs/lustrep3/users/doloriel/work/Repo/SPARC/cifar/robustbench/model_zoo/vision_transformer_rem.py:871: UserWarning: Overwriting vit_base_patch16_224_miil in registry with robustbench.model_zoo.vision_transformer_rem.vit_base_patch16_224_miil. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch16_224_miil(pretrained=False, **kwargs):
/scratch/project_465002264/miniconda3/envs/rem/lib/python3.8/site-packages/timm/models/hub.py:4: FutureWarning: Importing from timm.models.hub is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
[25/10/27 20:42:37] [conf.py:  459]: PyTorch Version: torch=2.2.0+rocm5.6, cuda=None, cudnn=2020000
[25/10/27 20:42:37] [conf.py:  461]: Using RNG seed: 1
[25/10/27 20:42:37] [conf.py:  462]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: /scratch/project_465002264/datasets/cifar100c
DESC: 
LOG_DEST: sparc_251027_204223.txt
LOG_TIME: 251027_204223
MODEL:
  ADAPTATION: REM
  ARCH: Standard_VITB_REM
  EPISODIC: False
  LN_QUARTER: default
OPTIM:
  AP: 0.92
  BETA: 0.9
  DAMPENING: 0.0
  KEEP: 288
  LAMB: 1.0
  LR: 0.0001
  M: 0.1
  MARGIN: 0.0
  METHOD: Adam
  MOMENTUM: 0.9
  MT: 0.999
  MT_ViDA: 0.999
  N: 3
  NESTEROV: True
  RST: 0.01
  STEPS: 2
  ViDALR: 0.0001
  WD: 0.0
PHASE:
  ALPHA: 0.45
  CHANNEL_ORDER: [0, 1, 2]
  CHANNEL_STEPS: [0, 1, 2, 3]
  CONSISTENCY_MODE: mcl
  CWAL_THRESHOLD: 0.7
  LEVELS: [0.0, 0.25, 0.3]
  SEED: None
  USE_ERL: True
  USE_MCL: True
RNG_SEED: 1
SAVE_DIR: ./output
SPARC:
  DISABLE_ERL: False
  DISABLE_MCL: False
  ERL_ACTIVATION: relu
  ERL_LEAKY_RELU_SLOPE: 0.01
  ERL_SOFTPLUS_BETA: 1.0
  LOGSPARC_ENABLE: beta
  LOGSPARC_LR_MULT: 5.0
  LOGSPARC_REG: 0.0
  LOGSPARC_TEMP: 0.0
  LOGSPARC_TYPE2: False
  LOGSPARC_TYPE3: False
  MASK_TYPE: binary
  MCL_DISTANCE: ce
  MCL_TEMPERATURE: 1.0
  MCL_TEMPERATURE_APPLY: both
  NUM_SQUARES: 1
  PATCH_SIZE: 8
  PLOT_EMA_ALPHA: 0.98
  PLOT_LOSS: False
  PLOT_LOSS_PATH: /users/doloriel/work/Repo/SPARC/cifar/plots/SPARC/Loss/losses.png
  RANDOM_MASKING: True
TEST:
  BATCH_SIZE: 20
  ckpt: None
  vida_rank1: 1
  vida_rank2: 128
block_size: 16
hog_ratio: None
mask_ratio: 0.5
size: 384
use_hog: False
[25/10/27 20:42:37] [cifar100c_vit_sparc.py:   42]: [cifar100] RNG seed in use: 1
[25/10/27 20:42:54] [cifar100c_vit_sparc.py:   67]: test-time adaptation: SPARC
[25/10/27 20:42:54] [cifar100c_vit_sparc.py:  340]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    weight_decay: 0.0
)
[25/10/27 20:42:54] [cifar100c_vit_sparc.py:   97]: resetting model
[25/10/27 20:43:30] [sparc.py: 1081]: [SPARC.debug] m=0.100
[25/10/27 20:43:31] [sparc.py: 1081]: [SPARC.debug] m=0.200
[25/10/27 20:43:44] [sparc.py: 1108]: [SPARC.debug] grad
[25/10/27 20:43:44] [sparc.py: 1081]: [SPARC.debug] m=0.100
[25/10/27 21:00:31] [cifar100c_vit_sparc.py:  118]: Error % [gaussian_noise5]: 31.16%
[25/10/27 21:00:31] [cifar100c_vit_sparc.py:  119]: NLL [gaussian_noise5]: 1.3652
[25/10/27 21:00:31] [cifar100c_vit_sparc.py:  120]: ECE [gaussian_noise5]: 0.1245
[25/10/27 21:00:31] [cifar100c_vit_sparc.py:  122]: Adaptation Time (lower is better) [gaussian_noise5]: 727.644s
[25/10/27 21:00:31] [cifar100c_vit_sparc.py:  123]: Adaptation MACs (lower is better) [gaussian_noise5]: 5.548 x 10^14
[25/10/27 21:00:31] [cifar100c_vit_sparc.py:  134]: Domain Shift Robustness (std, lower is better) up to [gaussian_noise5]: 0.0000
[25/10/27 21:00:31] [cifar100c_vit_sparc.py:  101]: not resetting model
